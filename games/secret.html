<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Уууу! секрет!</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* === Стили из предоставленного chat.txt (увеличенные) === */
        /*-Body-*/
        * {
            box-sizing: border-box;
        }
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(120deg, #3d3b3b, #0c1113);
            color: #ffffff;
            line-height: 1.6;
            overflow: hidden;
        }
        .bg {
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: 0;
            position: absolute;
            background: url('https://images.unsplash.com/photo-1451186859696-371d9477be93?crop=entropy&fit=crop&fm=jpg&h=975&ixjsv=2.1.0&ixlib=rb-0.3.5&q=80&w=1925') no-repeat 0 0;
            filter: blur(80px);
            transform: scale(1.2);
        }
        /*-Chat-*/
        .chat {
            /* Увеличиваем размеры */
            width: 90%; /* Ширина 90% от контейнера */
            max-width: 600px; /* Максимальная ширина 600px */
            height: 85vh; /* Высота 85% от viewport height */
            max-height: 700px; /* Максимальная высота 700px */
            /* Остальные стили из chat.txt */
            z-index: 2;
            overflow: hidden;
            box-shadow: 0 5px 30px rgba(20, 20, 20, 0.2);
            background: rgba(20, 20, 20, 0.5);
            border-radius: 20px;
            display: flex;
            justify-content: space-between;
            flex-direction: column;
            position: relative;
            margin: 2vh auto; /* Центрируем по горизонтали и добавляем отступы */
        }
        /*-Chat Title-*/
        .chat-title {
            flex: 0 1 45px;
            position: relative;
            z-index: 2;
            background: rgba(12, 11, 11, 0.2);
            color: #ffffff;
            text-transform: uppercase;
            text-align: left;
            padding: 10px 10px 10px 50px;
        }
        .chat-title h1, .chat-title h2 {
            font-weight: normal;
            font-size: 14px; /* Увеличиваем шрифт заголовка */
            margin: 0;
            padding: 0;
        }
        .chat-title h2 {
            color: rgb(0, 116, 39);
            font-size: 10px; /* Увеличиваем шрифт подзаголовка */
            letter-spacing: 1px;
        }
        .chat-title .avatar {
            position: absolute;
            z-index: 1;
            top: 8px;
            left: 9px;
            border-radius: 30px;
            width: 30px;
            height: 30px;
            overflow: hidden;
            margin: 0;
            padding: 0;
            border: 2px solid rgba(235, 235, 235, 0.329);
        }
        .chat-title .avatar img {
            width: 100%;
            height: auto;
        }
        /*-Messages-*/
        .messages {
            flex: 1 1 auto;
            color: rgba(255, 255, 255, 0.877);
            overflow-y: auto;
            position: relative;
            width: 100%;
            padding: 10px 5px;
            display: flex;
            flex-direction: column-reverse; /* Новые сообщения сверху */
        }
        .message {
            clear: both;
            float: left;
            padding: 8px 12px 9px; /* Увеличиваем padding */
            border-radius: 12px 12px 12px 0; /* Увеличиваем радиус */
            background: rgba(0, 0, 0, .3);
            margin: 10px 0; /* Увеличиваем margin */
            font-size: 14px; /* Увеличиваем размер шрифта */
            line-height: 1.5; /* Увеличиваем межстрочный интервал */
            margin-left: 35px; /* Отступ для аватарки */
            position: relative;
            text-shadow: 0 1px 1px rgba(0, 0, 0, .2);
            animation: fadeInUp 0.3s ease;
            max-width: 80%;
            word-wrap: break-word;
            /* --- Добавляем display: inline-block для адаптации фона --- */
            display: inline-block;
            /* --- Конец добавления --- */
        }
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        .message .text {
            margin-bottom: 5px;
        }
        .message .timestamp {
            position: absolute;
            bottom: -15px;
            font-size: 11px; /* Увеличиваем размер шрифта времени */
            color: rgba(255, 255, 255, .3);
            text-align: right;
            right: 0;
        }
        .message .avatar {
            position: absolute;
            z-index: 1;
            bottom: -15px;
            left: -35px;
            border-radius: 30px;
            width: 30px;
            height: 30px;
            overflow: hidden;
            margin: 0;
            padding: 0;
            border: 2px solid rgba(255, 255, 255, 0.24);
        }
        .message .avatar img {
            width: 100%;
            height: auto;
        }
        /* --- Стили для сообщения пользователя (message-new) --- */
        .message.message-new {
            float: right;
            color: #fff;
            text-align: right;
            background: linear-gradient(120deg, #00000088, #5c5b5b1a); /* Фон из chat.txt */
            border-radius: 12px 12px 0 12px; /* Увеличиваем радиус */
            margin-right: 35px; /* Отступ для аватарки справа */
            margin-left: 0;
            /* --- display: inline-block уже задан выше, наследуется --- */
        }
        .message.message-new .timestamp {
            right: auto;
            text-align: left;
        }
        .message.message-new .avatar {
            left: auto;
            right: -35px;
        }
        /* --- Конец стилей сообщения пользователя --- */

        /* === Конец стилей чата === */

        /* === Стили для комнаты === */
        .lisa-container {
            max-width: 900px; /* Увеличиваем максимальную ширину контейнера */
            height: 95vh; /* Увеличиваем высоту контейнера */
            margin: 2vh auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
        }
        .back-btn {
            align-self: flex-start;
            padding: 0.8rem 1.5rem;
            background: linear-gradient(120deg, #111312d5, #45464671);
            backdrop-filter: blur(10px);
            border: 1px solid rgb(65, 63, 63);
            border-radius: 25px;
            color: rgb(255, 255, 255);
            text-decoration: none;
            font-weight: 500;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
            z-index: 2; /* Выше фона */
        }
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-1px);
        }

        /* === Стили для вариантов ответов === */
        .replies-container {
            padding: 10px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        .reply-btn {
            flex: 1;
            min-width: 120px; /* Минимальная ширина кнопки */
            padding: 10px 15px;
            border-radius: 20px;
            border: none;
            background: linear-gradient(120deg, #3f3e3e80, #20202081);
            color: white;
            cursor: pointer;
            transition: background 0.3s ease;
            font-size: 0.9rem;
            text-align: center;
        }
        .reply-btn:hover {
            background: rgba(114, 114, 114, 0.9);
        }
        .reply-btn:disabled {
            background: rgba(106, 90, 205, 0.3);
            cursor: not-allowed;
        }

        /* === Стили для модального окна с фото === */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7); /* Полупрозрачный чёрный фон */
            backdrop-filter: blur(5px); /* Размытие фона */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10000; /* Очень высокий z-index */
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.show {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background: rgba(26, 26, 26, 0.9); /* Тёмный полупрозрачный фон */
            backdrop-filter: blur(10px); /* Более сильное размытие внутри окна */
            border-radius: 16px;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5); /* Тень */
            border: 1px solid rgba(255, 255, 255, 0.1); /* Тонкая обводка */
            max-width: 90%;
            width: auto;
            position: relative; /* Для позиционирования крестика */
        }
        .modal-content img {
            max-width: 100%;
            max-height: 70vh; /* Ограничиваем высоту */
            border-radius: 10px;
        }
        .close-modal {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: white;
            font-size: 1.5rem;
            cursor: pointer;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        .close-modal:hover {
            background: rgba(255, 255, 255, 0.2);
        }
        /* === Конец стилей модального окна === */
    </style>
</head>
<body>
    <div class="bg"></div> <!-- Фон -->
    <div class="lisa-container">
        <a href="../index.html" class="back-btn">← Обратно!</a>
        <div class="chat">
            <div class="chat-title">
                <div class="avatar">
                    <img src="../images/9.png" alt="Аватар пользователя">
                </div>
                <div class="user-info">
                    <h1>Плюшевый мишка</h1>
                    <h2>в сети</h2>
                </div>
            </div>
            <div class="messages" id="messages">
                <!-- Сообщения будут добавляться сюда -->
            </div>
            <!-- Контейнер для кнопок ответов -->
            <div class="replies-container" id="repliesContainer" style="display: none;">
                <!-- Кнопки будут добавляться сюда -->
            </div>
        </div>
    </div>

    <!-- Модальное окно для фото -->
    <div class="modal-overlay" id="photoModal">
        <div class="modal-content">
            <button class="close-modal" id="closeModalBtn">&times;</button>
            <img id="modalImage" src="" alt="Увеличенное фото">
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            const messagesDiv = document.getElementById('messages');
            const repliesContainer = document.getElementById('repliesContainer');
            const userAvatar = document.querySelector('.chat-title .avatar');
            const photoModal = document.getElementById('photoModal');
            const modalImage = document.getElementById('modalImage');
            const closeModalBtn = document.getElementById('closeModalBtn');

            // Функция для форматирования времени
            function formatTime(date) {
                return date.getHours().toString().padStart(2, '0') + ':' + date.getMinutes().toString().padStart(2, '0');
            }

            // Функция для добавления сообщения
            function addMessage(text, isVisitor = false) {
                const now = new Date();
                const timestamp = formatTime(now);
                const avatarSrc = isVisitor ? '../images/8.png' : '../images/10.png';
                const messageClass = isVisitor ? 'message message-visitor' : 'message message-new';

                // Создаём DOM элемент напрямую
                const messageDiv = document.createElement('div');
                messageDiv.className = messageClass;

                // Аватарка
                const avatarEl = document.createElement('figure');
                avatarEl.className = 'avatar';
                const imgEl = document.createElement('img');
                imgEl.src = avatarSrc;
                imgEl.alt = 'Avatar';
                avatarEl.appendChild(imgEl);
                messageDiv.appendChild(avatarEl);

                // Текст сообщения
                const textEl = document.createElement('div');
                textEl.className = 'text';
                textEl.textContent = text;
                messageDiv.appendChild(textEl);

                // Время
                const timeEl = document.createElement('div');
                timeEl.className = 'timestamp';
                timeEl.textContent = timestamp;
                messageDiv.appendChild(timeEl);

                // Добавляем сообщение в начало списка (prepend)
                messagesDiv.prepend(messageDiv);

                // Прокручиваем вниз
                messagesDiv.scrollTop = messagesDiv.scrollHeight;
            }

            // Состояние чата для отслеживания ветвления
            let chatState = 'start';

            // Ответы бота и варианты
            const botResponses = {
                start: {
                    text: "А ты как сюда попала, ты что, шпион?",
                    replies: [
                        { text: "Да димка", next: 'ok' },
                        { text: "Нет..?", next: 'bad' },
                        { text: "Возможно", next: 'question' }
                    ]
                },
                ok: {
                    text: "Ну и чего ты здесь забыла? это мой уголок так то. Тебя сюда не впускали любимая!",
                    replies: [
                        { text: "Ну и че", next: 'busy' },
                        { text: "Да пох", next: 'relax' },
                        { text: "Ну извини..", next: 'question' }
                    ]
                },
                bad: {
                    text: "Тогда возможно тебя ждет разговор дома...",
                    replies: [
                        { text: "О, да?", next: 'yes' },
                        { text: "Ну я жду", next: 'no' },
                        { text: "Это тебя ждет разговор дома!", next: 'question' }
                    ]
                },
                question: {
                    text: "Тогда это тебя ждет разговор дома! За такое по жопке бьют знаешь? Что в оправдание скажешь?",
                    replies: [
                        { text: "Люблю...", next: 'clarify' },
                        { text: "Ну............", next: 'change_topic' }
                    ]
                },
                busy: {
                    text: "Ну и че? Я вообще то для тебя сюрприз готовил так то, а ты вот так взяла и все нашла и все испортила, ну и как тебе сюрпризы такие готовить блин :(",
                    replies: [
                        { text: "Ну приготовишь еще сюрпризы мне, не бесись", next: 'agree' },
                        { text: "Все все, ладно, извини", next: 'disagree' }
                    ]
                },
                relax: {
                    text: "О как, пох?? Вот так и делай для тебя что нибудь приятное, а я ведь старался, силушки вкладывал!",
                    replies: [
                        { text: "Ты все равно умничка", next: 'question' },
                        { text: "Спасибо и за это Димка", next: 'question' },
                        { text: "Не переживай ты так, Дим", next: 'question' }
                    ]
                },
                yes: {
                    text: "Ну да, а ты что думала все так просто обойдется? Нет нет нет родная, жизнь не так сладка как кажется",
                    replies: [
                        { text: "Но я ведь тебя люблю сильно!", next: 'clarify' },
                        { text: "Ну тут мои полномочия все..", next: 'change_topic' }
                    ]
                },
                no: {
                    text: "Ну и жди, вот потом посмотрим как ты милашка запоешь",
                    replies: [
                        { text: "Это все равно мило Димка", next: 'change_topic' },
                        { text: "Прости Димка, я вообще сюда случайно тыкнула, но это очень мило", next: 'change_topic' }
                    ]
                },
                agree: {
                    text: "Приготовлю, но просто это хотелось сделать прям вау, а порой так сложно так делать, что и в голову не лезут все эти слова и словушки, но я всеравно рад что тебе это показал хоть в таком виде",
                    replies: [
                        { text: "Это правда мило что ты сделал, да и вообще сайт прикольный, мне все нравиться, ты молодец", next: 'question' },
                        { text: "Извини что я все порчу...", next: 'disagree' }
                    ]
                },
                disagree: {
                    text: "Да ладно, ничего страшного, зато это показывает какая ты любопытная, что мило на самом деле, чудо ты такое",
                    replies: [
                        { text: "Спасибо Дим, ты тоже милый", next: 'question' },
                        { text: "Ну я не знаю что сказать..", next: 'change_topic' }
                    ]
                },
                change_topic: {
                    text: "Да ничего, ладно. Можешь просто сказать одно слово, почему бы и нет, да?",
                    replies: [
                        { text: "Люблю", next: 'question' },
                        { text: "Обнимаю", next: 'question' },
                        { text: "Мишка ты", next: 'question' }
                    ]
                },
                clarify: {
                    text: "И я тебя сильно люблю лиз, ты милая даже в таких ситуациях и я это правда ценю",
                    replies: [
                        { text: "Спасибо Дим, ты лучший", next: 'end' },
                        { text: "Я рада тому что ты делаешь для меня", next: 'end' }
                    ]
                },
                end: {
                    text: "Честно мне хочется сказать мне как я рад писать для тебя эти слова и просто рад тому что у меня начинает получаться писать этот сайт, делать какие-то пасхалки, где то тебе показывать где они и просто стараться сделать хоть и не все идеально, но красиво, мило и со вкусом. Мне нравиться вот так стараться что то делать для тебя на досуге. Это меня и успокоивает и я знаю что ты ждешь от меня этот проект где я со временем все стараюсь делать лучше и лучше. Я рад что и ты в меня веришь, я честно хотел это забросить и знаешь, мне нравиться что получается и я рад что это все ради тебя и делается по сути благодаря тебе. Я рад что такими стараниями я хоть не порой не смогу удивлять прям, но улыбку как минимум сделаю. Честно мне изначально даже хотелось все это показать тебе вплоть до мелочей, но не было ведь бы той изюминки как сейчас, поэтому вот такая вот версия вышла. Еще раз спасибо за то что ты рядом, за то что переживаешь, ценишь, понимаешь. Да мы ссоримся, но я всегда хочу найти с тобой общий язык, стараюсь понять тебя, понять что для тебя важно, чем смогу помочь, просто отвлечь, все Лиз. Ты особенная девочка и ты мне нравишься такой и мне нравиться твой характер, твоя внешность и боже.. очень красивые глаза мне нравятся. Ты правда особенная, единственная такая и я думал вот чисто какой может быть для меня идеал, что бы и не было скучно и не было слишком тяжело эмоционально, в этом ты моя золотая серидина и в этом ты мой идеал, а дальше поживем увидем Лиз. Я просто хочу сказать что Люблю тебя и люблю то что ты делаешь. Чмок! ❤",
                    replies: null
                }
            };

            // Функция для отправки сообщения бота
            function sendBotMessage(state) {
                const response = botResponses[state];
                if (response) {
                    addMessage(response.text, true);
                    chatState = null;
                    showReplies(response.replies);
                } else {
                    addMessage("Не понимать, я же заранее запрограмирован на ответы", true);
                    showReplies(null);
                }
            }

            // Функция для показа вариантов ответов
            function showReplies(replies) {
                repliesContainer.innerHTML = '';
                if (replies && replies.length > 0) {
                    replies.forEach(reply => {
                        const button = document.createElement('button');
                        button.className = 'reply-btn';
                        button.textContent = reply.text;
                        button.onclick = () => handleReply(reply.text, reply.next);
                        repliesContainer.appendChild(button);
                    });
                    repliesContainer.style.display = 'flex';
                } else {
                    repliesContainer.style.display = 'none';
                }
            }

            // Функция для обработки выбора пользователя
            function handleReply(text, nextState) {
                addMessage(text, false);
                chatState = nextState;
                repliesContainer.style.display = 'none';

                // Имитация задержки перед ответом бота (2-3 секунды)
                setTimeout(() => {
                    if (chatState && botResponses[chatState]) {
                        sendBotMessage(chatState);
                    } else {
                        addMessage("Интересно... 🤔 Расскажи подробнее.", true);
                        showReplies(null);
                    }
                }, 2000 + Math.random() * 1000);
            }

            // --- Логика для модального окна ---
            userAvatar.addEventListener('click', function() {
                modalImage.src = '../images/9.png';
                photoModal.classList.add('show');
            });

            closeModalBtn.addEventListener('click', function() {
                photoModal.classList.remove('show');
            });

            // Закрытие модального окна при клике вне его
            photoModal.addEventListener('click', function(e) {
                if (e.target === photoModal) {
                    photoModal.classList.remove('show');
                }
            });

            // Первое сообщение бота
            setTimeout(() => {
                sendBotMessage('start');
            }, 1000);
        });
    </script>
</body>
</html>